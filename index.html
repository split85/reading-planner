<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const Icons = {
            BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            CheckCircle: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            Calendar: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Share2: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></svg>,
            Check: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>,
            PlayCircle: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>
        };

        function App() {
            const [copySuccess, setCopySuccess] = useState(false);
            const [error, setError] = useState("");
            
            const [draftConfig, setDraftConfig] = useState(() => {
                const saved = localStorage.getItem('Reading_planner_v8');
                const today = new Date().toISOString().split('T')[0];
                const defaultEnd = new Date(); defaultEnd.setDate(defaultEnd.getDate() + 30);
                return saved ? JSON.parse(saved) : { mode: 'dates', totalPages: 604, startPage: 1, endPage: 604, startDate: today, targetDate: defaultEnd.toISOString().split('T')[0], durationDays: 30 };
            });

            const [activeConfig, setActiveConfig] = useState(draftConfig);
            const [completedDays, setCompletedDays] = useState(() => {
                const saved = localStorage.getItem('Reading_progress_v8');
                return saved ? JSON.parse(saved) : {};
            });

            useEffect(() => { localStorage.setItem('Reading_planner_v8', JSON.stringify(activeConfig)); }, [activeConfig]);
            useEffect(() => { localStorage.setItem('Reading_progress_v8', JSON.stringify(completedDays)); }, [completedDays]);

            const handleCalculate = () => {
                setError("");
                if (draftConfig.totalPages <= 0) { setError("Total pages must be 1+"); return; }
                if (draftConfig.mode === 'dates' && new Date(draftConfig.targetDate) <= new Date(draftConfig.startDate)) { setError("End date must be after start"); return; }
                if (draftConfig.mode === 'duration' && draftConfig.durationDays <= 0) { setError("Duration must be 1+ days"); return; }
                setActiveConfig(draftConfig);
            };

            const scheduleData = useMemo(() => {
                let diffDays = activeConfig.mode === 'dates' ? 
                    Math.max(1, Math.ceil((new Date(activeConfig.targetDate) - new Date(activeConfig.startDate)) / (1000 * 60 * 60 * 24))) : 
                    activeConfig.durationDays;
                
                const sPage = activeConfig.startPage;
                const ePage = activeConfig.endPage;
                const totalPg = activeConfig.totalPages;
                let pagesToRead = (ePage >= sPage) ? (ePage - sPage + 1) : (totalPg - sPage + 1 + ePage);
                const rate = pagesToRead / diffDays;
                
                const list = [];
                for (let i = 1; i <= diffDays; i++) {
                    const pageOffset = Math.round(rate * i) - 1;
                    const targetPage = ((sPage + pageOffset - 1) % totalPg) + 1;
                    if (activeConfig.mode === 'dates') {
                        const d = new Date(activeConfig.startDate); d.setDate(d.getDate() + i);
                        list.push({ id: d.toISOString().split('T')[0], label: d.toLocaleDateString('en-US', { day: 'numeric', month: 'short' }), sub: d.toLocaleDateString('en-US', { weekday: 'short' }), target: targetPage });
                    } else {
                        list.push({ id: `day-${i}`, label: i, sub: 'DAY', target: targetPage });
                    }
                }
                return { list, days: diffDays, rate };
            }, [activeConfig]);

            const isDirty = JSON.stringify(draftConfig) !== JSON.stringify(activeConfig);
            const progress = Math.round((Object.values(completedDays).filter(Boolean).length / scheduleData.days) * 100) || 0;

            return (
                <div className="min-h-screen bg-slate-50 p-4 pb-10">
                    <div className="max-w-md mx-auto">
                        <header className="flex flex-col items-center mb-6">
                            <div className="bg-emerald-600 p-2.5 rounded-xl mb-2 text-white shadow-lg"><Icons.BookOpen /></div>
                            <h1 className="text-2xl font-black text-slate-800 tracking-tight text-center">Reading Planner</h1>
                        </header>

                        <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-5 mb-4">
                            <div className="flex justify-between items-center mb-5">
                                <div className="flex bg-slate-100 p-1 rounded-lg">
                                    {['dates', 'duration'].map(m => (
                                        <button key={m} onClick={() => setDraftConfig(p => ({...p, mode: m}))} className={`px-3 py-1.5 rounded-md text-[9px] font-black uppercase tracking-wider transition-all ${draftConfig.mode === m ? 'bg-white shadow-sm text-emerald-600' : 'text-slate-400'}`}>
                                            {m === 'dates' ? 'Date Range' : 'Days Count'}
                                        </button>
                                    ))}
                                </div>
                                <button onClick={() => {
                                    const url = window.location.href;
                                    const el = document.createElement('textarea'); el.value = url; document.body.appendChild(el); el.select(); document.execCommand('copy'); document.body.removeChild(el);
                                    setCopySuccess(true); setTimeout(() => setCopySuccess(false), 2000);
                                }} className="text-[10px] font-bold px-3 py-1.5 bg-slate-50 border border-slate-100 rounded-lg flex items-center gap-2">
                                    {copySuccess ? <Icons.Check className="w-3 text-emerald-600" /> : <Icons.Share2 className="w-3 text-slate-400" />} {copySuccess ? 'COPIED' : 'SHARE'}
                                </button>
                            </div>
                            
                            <div className="space-y-4">
                                <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Total Pages</label><input type="number" value={draftConfig.totalPages} onChange={e => setDraftConfig(p => ({...p, totalPages: parseInt(e.target.value)||0}))} className="bg-slate-50 border border-slate-100 p-3 rounded-xl text-sm font-bold w-full mt-1 outline-none focus:ring-2 focus:ring-emerald-500/20" /></div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Start Page</label><input type="number" value={draftConfig.startPage} onChange={e => setDraftConfig(p => ({...p, startPage: parseInt(e.target.value)||0}))} className="bg-slate-50 border border-slate-100 p-3 rounded-xl text-sm font-bold w-full mt-1 outline-none focus:ring-2 focus:ring-emerald-500/20" /></div>
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">End Page</label><input type="number" value={draftConfig.endPage} onChange={e => setDraftConfig(p => ({...p, endPage: parseInt(e.target.value)||0}))} className="bg-slate-50 border border-slate-100 p-3 rounded-xl text-sm font-bold w-full mt-1 outline-none focus:ring-2 focus:ring-emerald-500/20" /></div>
                                </div>
                                {draftConfig.mode === 'dates' ? (
                                    <div className="grid grid-cols-2 gap-4">
                                        <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Start Date</label><input type="date" value={draftConfig.startDate} onChange={e => setDraftConfig(p => ({...p, startDate: e.target.value}))} className="bg-slate-50 border border-slate-100 p-3 rounded-xl text-[11px] font-bold w-full mt-1 outline-none focus:ring-2 focus:ring-emerald-500/20" /></div>
                                        <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">End Date</label><input type="date" value={draftConfig.targetDate} onChange={e => setDraftConfig(p => ({...p, targetDate: e.target.value}))} className="bg-slate-50 border border-slate-100 p-3 rounded-xl text-[11px] font-bold w-full mt-1 outline-none focus:ring-2 focus:ring-emerald-500/20" /></div>
                                    </div>
                                ) : (
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Number of Days</label><input type="number" value={draftConfig.durationDays} onChange={e => setDraftConfig(p => ({...p, durationDays: parseInt(e.target.value)||0}))} className="bg-slate-50 border border-slate-100 p-3 rounded-xl text-sm font-bold w-full mt-1 outline-none focus:ring-2 focus:ring-emerald-500/20" /></div>
                                )}
                                {error && <div className="text-red-600 text-[10px] font-bold bg-red-50 p-3 rounded-xl border border-red-100">{error}</div>}
                                <button onClick={handleCalculate} className={`w-full py-4 rounded-2xl flex items-center justify-center gap-2 font-black text-xs uppercase tracking-widest transition-all ${isDirty ? 'bg-emerald-600 text-white shadow-lg shadow-emerald-200 active:scale-95' : 'bg-slate-100 text-slate-400 cursor-default'}`}>
                                    {isDirty ? <Icons.PlayCircle className="w-4 h-4" /> : <Icons.Check className="w-4 h-4" />} {isDirty ? "Apply Schedule" : "Schedule Active"}
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-2 gap-4 mb-4">
                            <div className="bg-emerald-600 text-white p-5 rounded-3xl shadow-lg shadow-emerald-100">
                                <p className="text-[9px] uppercase font-black opacity-80 tracking-widest">Daily Goal</p>
                                <p className="text-3xl font-black">{scheduleData.rate.toFixed(1)}</p>
                                <p className="text-[9px] font-bold opacity-60 mt-1 uppercase tracking-widest">{scheduleData.days} Days</p>
                            </div>
                            <div className="bg-white border border-slate-200 p-5 rounded-3xl flex flex-col justify-between">
                                <p className="text-[9px] uppercase font-black text-slate-400 tracking-widest">Completion</p>
                                <div>
                                    <p className="text-2xl font-black text-slate-800">{progress}%</p>
                                    <div className="w-full h-1.5 bg-slate-100 rounded-full mt-2 overflow-hidden"><div className="h-full bg-emerald-500 transition-all duration-500" style={{ width: `${progress}%` }}></div></div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm">
                            <div className="p-4 bg-slate-50 border-b text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2">
                                <Icons.Calendar className="w-4 h-4 text-emerald-600" /> Daily Breakdown
                            </div>
                            <div className="max-h-[400px] overflow-y-auto divide-y divide-slate-50 custom-scrollbar">
                                {scheduleData.list.map(item => (
                                    <div key={item.id} onClick={() => setCompletedDays(prev => ({ ...prev, [item.id]: !prev[item.id] }))} className={`flex items-center justify-between p-4 cursor-pointer transition-colors ${completedDays[item.id] ? 'bg-emerald-50/40' : 'hover:bg-slate-50'}`}>
                                        <div className="flex items-center gap-4">
                                            <div className={`w-12 h-12 rounded-2xl flex flex-col items-center justify-center text-[10px] font-black ${completedDays[item.id] ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-500'}`}>
                                                <span className="opacity-60 uppercase">{item.sub}</span>
                                                <span className="text-sm">{item.label}</span>
                                            </div>
                                            <div>
                                                <p className={`text-lg font-black ${completedDays[item.id] ? 'text-slate-300 line-through' : 'text-emerald-700'}`}>Page {item.target}</p>
                                            </div>
                                        </div>
                                        {completedDays[item.id] ? <Icons.CheckCircle className="text-emerald-500 w-7 h-7" /> : <div className="w-7 h-7 border-2 border-slate-100 rounded-full"></div>}
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
